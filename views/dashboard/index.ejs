<script>
    navigator.geolocation.getCurrentPosition(showPosition);
    function showPosition(position) {
        currentPosition = [position.coords.latitude, position.coords.longitude];
        console.log(currentPosition);
        fetch("/dashboard/location", {
            method: "POST",
            headers: {
                Accept: "application/json",
                "Content-Type": "application/json",
            },
            body: JSON.stringify({ currentPosition }),
        })
        .then(async (response) => {
            const data = await response.json();
            if (data.success === true) {
                console.log("location updated");
            } else {
                window.location.href = '/dashboard'
            }
        })
        .catch((err) => {console.log(err)});
    }
</script>
<h1>Welcome <%=user.name%></h1>